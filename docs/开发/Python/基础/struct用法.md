---
tags:
  - Python
---
`struct` 模块通过**格式字符串前缀**来指定字节序，无需手动转换字节，只需在格式符前加上对应前缀，模块会自动按指定字节序打包 / 解包数据。
## 字节序前缀
|前缀|字节序|说明|
|---|---|---|
|`@`|本机字节序|默认，随系统变化|
|`=`|本机标准字节序|字节数固定，字节序随系统|
|`<`|小端|低字节存低地址，常用|
|`>`|大端|高字节存低地址，网络协议|
|`!`|网络字节序|等同于大端（`>`）|
## 数据类型及符号对照表

| 分类          | 符号  | 含义                          | 字节数 | 取值范围（参考）                               |
| ----------- | --- | --------------------------- | --- | -------------------------------------- |
| **布尔型**     | `?` | 布尔值（bool）                   | 1   | True/False（对应 1/0）                     |
| **字符型**     | `c` | 单字符（bytes）                  | 1   | 单个字节（0x00 ~ 0xFF）                      |
|             | `b` | 有符号字符（signed char）          | 1   | -128 ~ 127                             |
|             | `B` | 无符号字符（unsigned char）        | 1   | 0 ~ 255                                |
| **短整型**     | `h` | 有符号短整型（short）               | 2   | -32768 ~ 32767                         |
|             | `H` | 无符号短整型（unsigned short）      | 2   | 0 ~ 65535                              |
| **整型**      | `i` | 有符号整型（int）                  | 4   | -2¹⁵ ~ 2¹⁵-1（-2147483648 ~ 2147483647） |
|             | `I` | 无符号整型（unsigned int）         | 4   | 0 ~ 4294967295                         |
| **长整型**     | `l` | 有符号长整型（long）                | 4   | 同 `i`（32 位）                            |
|             | `L` | 无符号长整型（unsigned long）       | 4   | 同 `I`                                  |
| **长长整型**    | `q` | 有符号长长整型（long long）          | 8   | -2⁶³ ~ 2⁶³-1                           |
|             | `Q` | 无符号长长整型（unsigned long long） | 8   | 0 ~ 2⁶⁴-1                              |
| **浮点型**     | `f` | 单精度浮点（float）                | 4   | 约 ±3.4×10³⁸（6-7 位有效数字）                 |
|             | `d` | 双精度浮点（double）               | 8   | 约 ±1.8×10³⁰⁸（15-17 位有效数字）              |
| **指针 / 地址** | `P` | 指针类型（void *）                | 4/8 | 随系统（32 位系统 4 字节，64 位系统 8 字节）           |
| **字符串**     | `s` | 定长字节串                       | n   | 需指定长度（如 `10s` 表示 10 字节字符串）             |
|             | `p` | 帕斯卡字符串（带长度）                 | n+1 | 首字节为长度，后接 n 字节内容                       |
## 打包/解包
```python
# 原始数据：十进制 258 → 二进制 00000001 00000010
num = 258

# 1. 小端（<）打包：低字节在前 → 00000010 00000001 → 十六进制 0x02 0x01
packed_little = struct.pack('<H', num)
print(f"小端打包结果: {packed_little.hex()}")  # 输出：0201

# 2. 大端（>）打包：高字节在前 → 00000001 00000010 → 十六进制 0x01 0x02
packed_big = struct.pack('>H', num)
print(f"大端打包结果: {packed_big.hex()}")    # 输出：0102

# 3. 解包：用对应字节序解包，还原原始数据
unpacked_little = struct.unpack('<H', packed_little)[0]
unpacked_big = struct.unpack('>H', packed_big)[0]
print(f"小端解包结果: {unpacked_little}")     # 输出：258
print(f"大端解包结果: {unpacked_big}")        # 输出：258

# 4. 跨字节序解包（错误示例，用于对比）
wrong_unpack = struct.unpack('>H', packed_little)[0]
print(f"用大端解小端数据: {wrong_unpack}")    # 输出：258 → 0x0201 转十进制是 513（错误）
```